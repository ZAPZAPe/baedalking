-- ====================================================================
-- 배달킹 - 사용하지 않는 테이블 정리 스크립트
-- 실행 전에 반드시 데이터 백업을 하세요!
-- ====================================================================

-- 경고: 이 스크립트는 데이터를 영구적으로 삭제합니다.
-- 실행하기 전에 반드시 백업을 수행하세요.

-- ====================================================================
-- 1. 사용하지 않는 테이블 및 뷰 삭제
-- ====================================================================

-- 친구 요청 시스템 (사용하지 않음)
DROP TABLE IF EXISTS friend_requests CASCADE;

-- 복잡한 초대 코드 시스템 (단순화된 버전으로 대체)
DROP TABLE IF EXISTS invite_codes CASCADE;

-- 부정행위 기록 (현재 사용하지 않음)
DROP TABLE IF EXISTS fraud_records CASCADE;

-- 통계 테이블 (실시간 뷰로 대체)
DROP TABLE IF EXISTS statistics CASCADE;

-- 복잡한 설정 테이블 (key-value 방식으로 단순화)
DROP TABLE IF EXISTS settings CASCADE;

-- 기존 대시보드 통계
DROP VIEW IF EXISTS dashboard_stats CASCADE;

-- ====================================================================
-- 2. 사용하지 않는 인덱스 정리
-- ====================================================================

-- 삭제된 테이블의 인덱스들은 CASCADE로 자동 삭제됨

-- ====================================================================
-- 3. 사용하지 않는 함수 정리
-- ====================================================================

-- 복잡한 통계 업데이트 함수
DROP FUNCTION IF EXISTS update_statistics() CASCADE;

-- ====================================================================
-- 4. 정리 완료 메시지
-- ====================================================================

-- 정리 완료 확인
SELECT 
  'cleanup_completed' as status,
  CURRENT_TIMESTAMP as completed_at,
  'Unused tables and objects have been removed' as message; 